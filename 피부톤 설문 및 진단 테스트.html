document.addEventListener('DOMContentLoaded', function() {
      const skinSurvey = document.getElementById('skinSurvey');
      const resultContainer = document.getElementById('result-container');
      const printBtn = document.getElementById('print-btn');
      const resetBtn = document.getElementById('reset-btn');
      
      // 뷰티 코드 매핑 데이터 및 상세 정보
      const beautyCodeMapping = {
        // 건조 + 내성
        'DRCT': {
          name: '드라이 레지스턴트 클리어 타입',
          description: '건조하지만 외부 자극에 강한 피부입니다. 트러블은 적지만 건조함을 느끼는 타입입니다.',
          summary: '피부가 건조하지만 자극에 크게 민감하지 않습니다. 보습에 중점을 두되, 다양한 제품을 시도해볼 수 있습니다.',
          features: [
            '건조함을 느끼지만 자극에는 강함',
            '보습이 가장 중요한 포인트',
            '다양한 활성 성분 사용 가능'
          ],
          products: [
            '부드러운 크림 타입 클렌저',
            '고보습 에센스 토너',
            '히알루론산 세럼',
            '영양 크림'
          ],
          amRoutine: [
            '미온수로 가볍게 세안',
            '보습 토너 사용',
            '수분 앰플 사용',
            '보습 크림 사용',
            '자외선 차단제 사용'
          ],
          pmRoutine: [
            '클렌징 오일로 메이크업 제거',
            '부드러운 폼 클렌저로 세안',
            '고농축 보습 세럼 사용',
            '영양 크림 사용',
            '주 2-3회 보습 마스크팩 사용'
          ],
          analysis: {
            hydration: '건조한 편으로 수분 공급이 필요함',
            sensitivity: '외부 자극에 강한 편',
            trouble: '트러블이 거의 없는 편',
            tone: '피부 톤이 균일한 편'
          }
        },
        
        // 건조 + 민감
        'DSCT': {
          name: '드라이 센서티브 클리어 타입',
          description: '건조하고 민감한 피부로, 외부 자극에 예민하게 반응합니다. 트러블은 적은 편이나 건조함으로 인한 불편함이 있습니다.',
          summary: '피부 장벽이 약해 외부 자극에 민감하고 수분 유지가 어려운 타입입니다. 보습과 진정에 중점을 둔 관리가 필요합니다.',
          features: [
            '건조함과 당김이 심함',
            '자극에 민감하게 반응',
            '저자극, 고보습 제품 사용 필요'
          ],
          products: [
            '크림 타입 저자극 클렌저',
            '세라마이드 함유 고보습 토너',
            '판테놀 진정 에센스',
            '오일 함유 보습 크림'
          ],
          amRoutine: [
            '미온수로 가볍게 세안 혹은 토너 세안',
            '보습 토너로 수분 공급',
            '보습 에센스 사용',
            '고보습 크림으로 수분 잠금',
            '자외선 차단제 사용'
          ],
          pmRoutine: [
            '크림 타입 클렌저로 부드럽게 세안',
            '보습 토너 듬뿍 사용',
            '영양 세럼 사용',
            '오일 혼합 크림으로 보습 강화',
            '오버나이트 마스크 주 2-3회 사용'
          ],
          analysis: {
            hydration: '건조한 편으로 수분 공급이 필요함',
            sensitivity: '자극에 민감하게 반응하는 편',
            trouble: '트러블이 거의 없는 편',
            tone: '피부 톤이 밝고 투명한 편'
          }
        },
        
        // 건조 + 민감 + 트러블
        'DSTT': {
          name: '드라이 센서티브 트러블 타입',
          description: '건조하면서도 민감하고 트러블이 있는 복합적인 문제성 피부입니다.',
          summary: '건조함과 민감함에 트러블까지 있어 관리가 까다로운 피부입니다. 과도한 각질 제거를 자제하고 수분과 진정에 중점을 두어야 합니다.',
          features: [
            '건조함과 트러블이 동시에 나타남',
            '외부 자극에 민감하게 반응',
            '과도한 각질 제거 자제 필요'
          ],
          products: [
            '약산성 저자극 클렌저',
            '진정 효과가 있는 토너',
            'LHA 또는 PHA 성분의 순한 각질 케어 제품',
            '세라마이드 함유 보습 크림'
          ],
          amRoutine: [
            '미온수로 가볍게 세안',
            '진정 토너 사용',
            '가벼운 수분 세럼 사용',
            '보습 크림 사용',
            '자외선 차단제 사용'
          ],
          pmRoutine: [
            '저자극 클렌저로 세안',
            '진정 토너 사용',
            '트러블 부위에 국소 치료제 사용',
            '보습 크림으로 마무리',
            '주 1-2회 수분 마스크팩 사용'
          ],
          analysis: {
            hydration: '건조한 편으로 보습이 필요함',
            sensitivity: '자극에 민감하게 반응하는 편',
            trouble: '트러블이 자주 발생하는 편',
            tone: '피부 톤이 밝은 편'
          }
        },

        // 균형 + 민감
        'BSCT': {
          name: '밸런스 센서티브 클리어 타입',
          description: '수분과 유분이 균형을 이루며, 외부 자극에 민감하게 반응하는 피부입니다. 트러블은 적은 편이고 피부 톤이 맑은 편입니다.',
          summary: '환경 변화에 민감하게 반응하는 피부로, 붉어짐, 자극, 따가움이 자주 발생합니다. 피부 장벽이 약화될 수 있으므로 진정과 보습 중심의 관리가 필요합니다.',
          features: [
            '붉어짐과 자극에 민감하게 반응함',
            '유수분 밸런스가 불안정함',
            '민감성 전용 제품 사용 권장'
          ],
          products: [
            '무향 약산성 진정 토너',
            '저자극 세라마이드 앰플',
            '민감성 전용 수분크림 및 선크림'
          ],
          amRoutine: [
            '미온수로 가볍게 세안',
            '저자극 토너로 피부결 정돈',
            '보습 세럼 사용',
            '보습 크림으로 피부 보호',
            'SPF 30 이상 자외선 차단제 사용'
          ],
          pmRoutine: [
            '저자극 클렌저로 세안',
            '진정 토너 사용',
            '세라마이드 함유 앰플 사용',
            '회복을 위한 수면팩 1-2회/주 사용',
            '충분한 수면으로 피부 회복 돕기'
          ],
          analysis: {
            hydration: '적절한 수분 밸런스 유지',
            sensitivity: '자극에 민감하게 반응하는 편',
            trouble: '트러블이 거의 없는 깨끗한 피부',
            tone: '피부 톤이 밝고 투명한 편'
          }
        },

        // 균형 + 민감 + 트러블
        'BSTT': {
          name: '밸런스 센서티브 트러블 타입',
          description: '수분과 유분이 균형을 이루며, 외부 자극에 민감하게 반응하는 피부입니다. 트러블이 종종 발생하며 피부 톤이 맑은 편입니다.',
          summary: '환경 변화에 민감하게 반응하는 피부로, 붉어짐, 자극, 따가움이 자주 발생합니다. 피부 장벽이 약화될 수 있으므로 진정과 보습 중심의 관리가 필요합니다.',
          features: [
            '붉어짐과 자극에 민감하게 반응함',
            '유수분 밸런스가 불안정함',
            '트러블과 민감도를 동시에 관리해야 함'
          ],
          products: [
            '무향 약산성 진정 토너',
            '저자극 센텔라 함유 앰플',
            'BHA 성분 함유 스팟 트리트먼트',
            '진정 효과가 있는 수분크림'
          ],
          amRoutine: [
            '미온수로 가볍게 세안',
            '진정 토너로 피부결 정돈',
            '가벼운 수분 세럼 사용',
            '수분크림으로 보습',
            '자외선 차단제 필수 사용'
          ],
          pmRoutine: [
            '저자극 클렌저로 꼼꼼히 세안',
            '진정 토너 사용',
            '트러블 부위에 스팟 트리트먼트 사용',
            '회복을 위한 진정 크림 사용',
            '피부 진정 시트 마스크 2-3회/주 사용'
          ],
          analysis: {
            hydration: '적절한 수분 밸런스 유지',
            sensitivity: '자극에 민감하게 반응하는 편',
            trouble: '트러블이 자주 발생하는 편',
            tone: '피부 톤이 밝고 투명한 편'
          }
        },

        // 지성 + 민감
        'OSCT': {
          name: '오일리 센서티브 클리어 타입',
          description: '유분은 많으나 트러블은 거의 없는 민감성 피부입니다.',
          summary: '피지 분비는 많으나 피부 장벽이 약해 자극에 민감하게 반응합니다. 과도한 피지 조절보다는 균형 있는 관리가 중요합니다.',
          features: [
            '번들거림이 있으나 트러블은 적음',
            '자극적인 성분에 민감하게 반응',
            '피지 조절과 진정을 동시에 고려'
          ],
          products: [
            '약산성 젤 클렌저',
            '칼라민 함유 진정 토너',
            '가벼운 오일 프리 수분 에센스',
            '진정 효과가 있는 매트 젤 크림'
          ],
          amRoutine: [
            '젤 타입 클렌저로 세안',
            '알코올 프리 토너 사용',
            '가벼운 수분 에센스 사용',
            '오일 프리 수분 젤 사용',
            '자외선 차단제 사용'
          ],
          pmRoutine: [
            '오일 클렌징 후 젤 클렌저로 2차 세안',
            '진정 토너 사용',
            '수분 공급 세럼 사용',
            '가벼운 수분 크림 사용',
            '주 1-2회 수분 마스크팩 사용'
          ],
          analysis: {
            hydration: '유분은 많으나 수분은 부족할 수 있음',
            sensitivity: '자극에 민감하게 반응하는 편',
            trouble: '트러블이 거의 없는 깨끗한 피부',
            tone: '피부 톤이 밝고 투명한 편'
          }
        },

        // 지성 + 민감 + 트러블
        'OSTT': {
          name: '오일리 센서티브 트러블 타입',
          description: '피지 분비가 많으면서도 외부 자극에 민감한 피부입니다. 트러블이 자주 발생하고 피부 톤은 투명한 편입니다.',
          summary: '피지 조절과 함께 자극 없는 제품으로 진정 케어가 필요합니다. 과도한 세안은 오히려 유분 분비를 촉진할 수 있습니다.',
          features: [
            '번들거림과 트러블이 동시에 발생',
            '자극적인 성분에 민감하게 반응',
            '진정과 유분 조절 동시 케어 필요'
          ],
          products: [
            '저자극 약산성 클렌저',
            '판테놀 또는 진정 성분 함유 토너',
            '비오일 포뮬러 수분 에센스',
            '가벼운 텍스처의 진정 젤 크림'
          ],
          amRoutine: [
            '젤 타입 클렌저로 가볍게 세안',
            '피지 조절 토너 사용',
            '유분없는 수분 에센스 사용',
            '오일프리 수분 크림 사용',
            '매트한 마무리의 선크림 사용'
          ],
          pmRoutine: [
            '오일 클렌저 사용 (더블 클렌징)',
            '각질 정돈을 위한 저자극 BHA 토너 (주 2-3회)',
            '피지 조절 세럼 사용',
            '가벼운 젤 타입 크림 사용',
            '진정 마스크팩 주 2회 사용'
          ],
          analysis: {
            hydration: '유분기가 많고 번들거림',
            sensitivity: '외부 자극에 민감하게 반응함',
            trouble: '트러블이 자주 발생하는 편',
            tone: '피부 톤이 투명한 편'
          }
        }
      };
      
      // 모든 가능한 코드 조합 생성 함수
      function generateAllCodes() {
        const moistureTypes = ['D', 'B', 'O']; // Dry, Balanced, Oily
        const sensitivityTypes = ['R', 'S']; // Resistant, Sensitive
        const troubleTypes = ['C', 'T']; // Clear, Trouble
        const toneTypes = ['M', 'T']; // Matte, Translucent
        
        moistureTypes.forEach(m => {
          sensitivityTypes.forEach(s => {
            troubleTypes.forEach(t => {
              toneTypes.forEach(tone => {
                const code = m + s + t + tone;
                // 기본 데이터가 없는 경우에만 기본 데이터 생성
                if (!beautyCodeMapping[code]) {
                  beautyCodeMapping[code] = {
                    name: `${m === 'D' ? '건조' : m === 'B' ? '균형' : '지성'} ${s === 'R' ? '내성' : '민감'} ${t === 'C' ? '클리어' : '트러블'} ${tone === 'M' ? '무광' : '광채'} 타입`,
                    description: `${m === 'D' ? '건조하고' : m === 'B' ? '균형 잡히고' : '지성이고'} ${s === 'R' ? '민감하지 않으며' : '민감하며'}, 트러블이 ${t === 'C' ? '적고' : '많고'} 피부 톤이 ${tone === 'M' ? '탁한' : '맑은'} 편의 피부`,
                    summary: `${m === 'D' ? '보습' : m === 'B' ? '균형 유지' : '유분 조절'}과 ${s === 'S' ? '진정' : '활력'} 케어가 중요합니다. ${t === 'T' ? '트러블 관리에 신경써야 합니다.' : ''}`,
                    features: [
                      `${m === 'D' ? '건조함 개선 필요' : m === 'B' ? '균형 잡힌 유수분 관리' : '과도한 유분 조절 필요'}`,
                      `${s === 'S' ? '자극에 민감하게 반응' : '외부 자극에 강한 피부'}`,
                      `${t === 'T' ? '트러블 관리 필요' : '깨끗한 피부 유지'}`
                    ],
                    products: [
                      `${m === 'D' ? '고보습 토너' : m === 'B' ? '밸런싱 토너' : '피지 조절 토너'}`,
                      `${s === 'S' ? '진정 에센스' : '활력 에센스'}`,
                      `${t === 'T' ? '트러블 케어 세럼' : '영양 공급 세럼'}`
                    ],
                    amRoutine: [
                      `${m === 'D' ? '부드러운 크림 타입 클렌저로 세안' : m === 'B' ? '젤 타입 클렌저로 세안' : '포밍 클렌저로 세안'}`,
                      `${s === 'S' ? '저자극 토너 사용' : '밸런싱 토너 사용'}`,
                      `수분 에센스 사용`,
                      `${m === 'D' ? '보습 크림 사용' : m === 'B' ? '밸런싱 크림 사용' : '오일프리 수분 크림 사용'}`,
                      `자외선 차단제 사용`
                    ],
                    pmRoutine: [
                      `${m === 'D' ? '오일 클렌저로 메이크업 제거' : '더블 클렌징으로 메이크업 제거'}`,
                      `${s === 'S' ? '저자극 토너 사용' : '피부결 정돈 토너 사용'}`,
                      `${t === 'T' ? '트러블 케어 세럼 사용' : '영양 세럼 사용'}`,
                      `${m === 'D' ? '영양 크림 사용' : m === 'B' ? '밸런싱 크림 사용' : '가벼운 수분 크림 사용'}`,
                      `주 2-3회 ${m === 'D' ? '보습' : t === 'T' ? '진정' : '영양'} 마스크팩 사용`
                    ],
                    analysis: {
                      hydration: m === 'D' ? '건조한 편으로 수분 공급이 필요함' : m === 'B' ? '적절한 수분 밸런스 유지' : '유분기가 많은 편',
                      sensitivity: s === 'R' ? '외부 자극에 강한 편' : '자극에 민감하게 반응하는 편',
                      trouble: t === 'C' ? '트러블이 거의 없는 깨끗한 피부' : '트러블이 자주 발생하는 편',
                      tone: tone === 'M' ? '피부 톤이 다소 탁하거나 균일하지 않음' : '피부 톤이 밝고 투명한 편'
                    }
                  };
                }
              });
            });
          });
        });
      }
      
      // 모든 코드 조합 생성 실행
      generateAllCodes();
      
      // 응답 텍스트 매핑
      const responseTextMapping = {
        gender: {
          'female': '여성',
          'male': '남성'
        },
        age: {
          '10s': '10대',
          '20s': '20대',
          '30s': '30대',
          '40s': '40대',
          '50s': '50대',
          '60s': '60대 이상'
        },
        hydration: {
          '1': '매우 부족',
          '2': '부족',
          '3': '보통',
          '4': '충분',
          '5': '매우 충분'
        },
        tightness: {
          '1': '전혀 없음',
          '2': '약간 있음',
          '3': '보통',
          '4': '자주 느껴짐',
          '5': '항상 당김'
        },
        trouble: {
          '1': '없음',
          '2': '가끔',
          '3': '보통',
          '4': '자주',
          '5': '항상 있음'
        },
        sensitivity: {
          '1': '매우 둔감',
          '2': '약간 둔감',
          '3': '보통',
          '4': '민감',
          '5': '매우 민감'
        },
        sebum: {
          '1': '매우 적음',
          '2': '적음',
          '3': '보통',
          '4': '많음',
          '5': '매우 많음'
        },
        zone: {
          '1': '전체 건성',
          '2': 'T존만 지성',
          '3': 'U존만 지성',
          '4': '전체 지성',
          '5': '혼합성'
        },
        tone: {
          '1': '매우 밝음',
          '2': '밝음',
          '3': '보통',
          '4': '어두움',
          '5': '매우 어두움'
        }
      };
      
      // 결과 표시 함수
      function displayResults(beautyCode) {
        // 뷰티 코드 정보 가져오기
        const codeInfo = beautyCodeMapping[beautyCode] || {
          name: '기본 타입',
          description: '피부 분석 결과를 찾을 수 없습니다.',
          summary: '더 정확한 분석을 위해 다시 진단해보세요.',
          features: [],
          products: [],
          amRoutine: [],
          pmRoutine: [],
          analysis: {
            hydration: '정보 없음',
            sensitivity: '정보 없음',
            trouble: '정보 없음',
            tone: '정보 없음'
          }
        };
        
        // 응답 정보 표시
        if (document.querySelector('input[name="gender"]:checked')) {
          document.getElementById('response-gender').textContent = responseTextMapping.gender[document.querySelector('input[name="gender"]:checked').value];
        }
        if (document.querySelector('input[name="age"]:checked')) {
          document.getElementById('response-age').textContent = responseTextMapping.age[document.querySelector('input[name="age"]:checked').value];
        }
        if (document.querySelector('input[name="hydration"]:checked')) {
          document.getElementById('response-hydration').textContent = responseTextMapping.hydration[document.querySelector('input[name="hydration"]:checked').value];
        }
        if (document.querySelector('input[name="tightness"]:checked')) {
          document.getElementById('response-tightness').textContent = responseTextMapping.tightness[document.querySelector('input[name="tightness"]:checked').value];
        }
        if (document.querySelector('input[name="trouble"]:checked')) {
          document.getElementById('response-trouble').textContent = responseTextMapping.trouble[document.querySelector('input[name="trouble"]:checked').value];
        }
        if (document.querySelector('input[name="sensitivity"]:checked')) {
          document.getElementById('response-sensitivity').textContent = responseTextMapping.sensitivity[document.querySelector('input[name="sensitivity"]:checked').value];
        }
        if (document.querySelector('input[name="sebum"]:checked')) {
          document.getElementById('response-sebum').textContent = responseTextMapping.sebum[document.querySelector('input[name="sebum"]:checked').value];
        }
        if (document.querySelector('input[name="zone"]:checked')) {
          document.getElementById('response-zone').textContent = responseTextMapping.zone[document.querySelector('input[name="zone"]:checked').value];
        }
        if (document.querySelector('input[name="tone"]:checked')) {
          document.getElementById('response-tone').textContent = responseTextMapping.tone[document.querySelector('input[name="tone"]:checked').value];
        }
        
        // 뷰티 코드 표시
        document.getElementById('skin-type-name').textContent = codeInfo.name;
        document.getElementById('code-letter-1').textContent = beautyCode[0];
        document.getElementById('code-letter-2').textContent = beautyCode[1];
        document.getElementById('code-letter-3').textContent = beautyCode[2];
        document.getElementById('code-letter-4').textContent = beautyCode[3];
        document.getElementById('type-description').textContent = codeInfo.summary;
        
        // 분석 결과 표시
        document.getElementById('hydration-result').textContent = codeInfo.analysis.hydration;
        document.getElementById('sensitivity-result').textContent = codeInfo.analysis.sensitivity;
        document.getElementById('trouble-result').textContent = codeInfo.analysis.trouble;
        document.getElementById('tone-result').textContent = codeInfo.analysis.tone;
        
        // 특징 목록 표시
        const featureList = document.getElementById('feature-list');
        featureList.innerHTML = '';
        
        codeInfo.features.forEach(feature => {
          const featureItem = document.createElement('div');
          featureItem.className = 'feature-item';
          featureItem.innerHTML = `
            <div class="feature-icon">✓</div>
            <div>${feature}</div>
          `;
          featureList.appendChild(featureItem);
        });
        
        // AM 루틴 표시
        const amRoutine = document.getElementById('am-routine');
        amRoutine.innerHTML = '';
        
        codeInfo.amRoutine.forEach(step => {
          const li = document.createElement('li');
          li.textContent = step;
          amRoutine.appendChild(li);
        });
        
        // PM 루틴 표시
        const pmRoutine = document.getElementById('pm-routine');
        pmRoutine.innerHTML = '';
        
        codeInfo.pmRoutine.forEach(step => {
          const li = document.createElement('li');
          li.textContent = step;
          pmRoutine.appendChild(li);
        });
        
        // 제품 추천 목록 표시
        const productList = document.getElementById('product-list');
        productList.innerHTML = '';
        
        codeInfo.products.forEach(product => {
          const productItem = document.createElement('div');
          productItem.className = 'product-item';
          productItem.innerHTML = `
            <div class="product-icon">🔸</div>
            <div>${product}</div>
          `;
          productList.appendChild(productItem);
        });
        
        // 결과 표시
        resultContainer.classList.add('active');
        
        // 스크롤 자동 이동
        resultContainer.scrollIntoView({ behavior: 'smooth' });
        
        // URL에 코드 추가
        const url = new URL(window.location);
        url.searchParams.set('code', beautyCode);
        window.history.replaceState({}, '', url);
      }
      
      // URL 파라미터 확인 및 결과 표시 함수
      function checkUrlParams() {
        const urlParams = new URLSearchParams(window.location.search);
        const codeParam = urlParams.get('code');
        
        if (codeParam && codeParam.length === 4) {
          // 유효한 뷰티 코드 형식인지 확인
          const validFirstChars = ['D', 'B', 'O'];
          const validSecondChars = ['R', 'S'];
          const validThirdChars = ['C', 'T'];
          const validFourthChars = ['M', 'T'];
          
          const isValidCode = 
            validFirstChars.includes(codeParam[0]) && 
            validSecondChars.includes(codeParam[1]) && 
            validThirdChars.includes(codeParam[2]) && 
            validFourthChars.includes(codeParam[3]);
          
          if (isValidCode) {
            displayResults(codeParam);
            return true;
          }
        }
        return false;
      }
      
      // 페이지 로드 시 URL 파라미터 확인
      checkUrlParams();
      
      // 폼 제출 이벤트 핸들러
      skinSurvey.addEventListener('submit', function(e) {
        e.preventDefault();
        
        // 폼 데이터 수집
        const hydrationScore = parseInt(document.querySelector('input[name="hydration"]:checked').value);
        const tightnessScore = parseInt(document.querySelector('input[name="tightness"]:checked').value);
        const troubleScore = parseInt(document.querySelector('input[name="trouble"]:checked').value);
        const sensitivityScore = parseInt(document.querySelector('input[name="sensitivity"]:checked').value);
        const sebumScore = parseInt(document.querySelector('input[name="sebum"]:checked').value);
        const zoneScore = parseInt(document.querySelector('input[name="zone"]:checked').value);
        const toneScore = parseInt(document.querySelector('input[name="tone"]:checked').value);
        
        // 수분 점수 계산 (수분 섭취량 + 세안 당김의 반대값 + 피지 분비량 + T존/U존 특성)
        const moistureScore = (hydrationScore + (6 - tightnessScore) + (6 - sebumScore) + (6 - zoneScore)) / 4;
        
        // 뷰티 코드 생성
        let beautyCode = '';
        
        // 첫 번째 자리: 수분 상태
        if (moistureScore <= 2.5) {
          beautyCode += 'D'; // Dry
        } else if (moistureScore <= 3.5) {
          beautyCode += 'B'; // Balanced
        } else {
          beautyCode += 'O'; // Oily
        }
        
        // 두 번째 자리: 민감도
        if (sensitivityScore <= 2.5) {
          beautyCode += 'R'; // Resistant
        } else {
          beautyCode += 'S'; // Sensitive
        }
        
        // 세 번째 자리: 트러블 빈도
        if (troubleScore <= 2.5) {
          beautyCode += 'C'; // Clear
        } else {
          beautyCode += 'T'; // Trouble
        }
        
        // 네 번째 자리: 피부 톤/혈색
        if (toneScore <= 2.5) {
          beautyCode += 'M'; // Matte
        } else {
          beautyCode += 'T'; // Translucent
        }
        
        // 결과 표시
        displayResults(beautyCode);
      });
      
      // 인쇄 버튼 이벤트 리스너
      printBtn.addEventListener('click', function() {
        // 인쇄 전 준비
        document.body.classList.add('printing');
        
        // 필요에 따라 인쇄 제목 설정
        const skinType = document.getElementById('skin-type-name').textContent;
        const beautyCode = document.getElementById('code-letter-1').textContent + 
                        document.getElementById('code-letter-2').textContent + 
                        document.getElementById('code-letter-3').textContent + 
                        document.getElementById('code-letter-4').textContent;
        
        document.title = `Beauty Code ${beautyCode} - ${skinType} 진단결과`;
        
        // 잠시 지연 후 인쇄 실행 (렌더링 시간 확보)
        setTimeout(function() {
          window.print();
          
          // 인쇄 후 클래스 제거
          setTimeout(function() {
            document.body.classList.remove('printing');
            document.title = '피부 코드 진단 시스템';
          }, 1000);
        }, 300);
      });
      
      // 재시작 버튼 이벤트 리스너
      resetBtn.addEventListener('click', function() {
        skinSurvey.reset();
        resultContainer.classList.remove('active');
        
        // URL에서 코드 파라미터 제거
        const url = new URL(window.location);
        url.searchParams.delete('code');
        window.history.replaceState({}, '', url);
        
        // 설문 영역으로 스크롤
        document.querySelector('.survey-section').scrollIntoView({ behavior: 'smooth' });
      });
    });<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>피부 코드 진단 시스템</title>
  <!-- 글꼴 추가 -->
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --primary-color: #3f51b5;
      --secondary-color: #7986cb;
      --light-color: #f8f9fa;
      --dark-color: #343a40;
      --success-color: #4caf50;
      --warning-color: #ff9800;
    }
    
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: 'Noto Sans KR', sans-serif;
    }
    
    body {
      background-color: #f5f5f5;
      color: var(--dark-color);
      line-height: 1.6;
    }
    
    .container {
      max-width: 1000px;
      margin: 0 auto;
      padding: 20px;
    }
    
    header {
      text-align: center;
      margin-bottom: 30px;
      padding: 20px;
      background-color: white;
      border-radius: 10px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    }
    
    h1 {
      color: var(--primary-color);
      margin-bottom: 10px;
    }
    
    h2 {
      color: var(--secondary-color);
      margin: 20px 0;
    }
    
    .card {
      background-color: white;
      border-radius: 10px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      margin-bottom: 20px;
      padding: 20px;
    }

    .main-container {
      display: flex;
      flex-wrap: wrap;
      gap: 20px;
    }

    .survey-section {
      flex: 1;
      min-width: 300px;
    }

    .result-section {
      flex: 2;
      min-width: 500px;
    }
    
    .form-group {
      margin-bottom: 15px;
    }
    
    .form-group label {
      display: block;
      font-weight: bold;
      margin-bottom: 8px;
    }
    
    .options {
      display: flex;
      justify-content: space-between;
      flex-wrap: wrap;
    }
    
    .option-label {
      display: block;
      font-size: 0.8rem;
      text-align: center;
      margin-top: 5px;
    }
    
    .radio-group {
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    
    input[type="radio"] {
      margin-bottom: 5px;
    }
    
    button {
      background-color: var(--primary-color);
      color: white;
      border: none;
      padding: 10px 20px;
      font-size: 1rem;
      border-radius: 5px;
      cursor: pointer;
      transition: background-color 0.3s;
      display: block;
      margin: 20px auto;
      width: 200px;
    }
    
    button:hover {
      background-color: var(--secondary-color);
    }
    
    #result-container {
      display: none;
    }

    #result-container.active {
      display: block;
    }
    
    /* 결과 스타일 */
    .report-header {
      display: flex;
      align-items: center;
      padding-bottom: 15px;
      border-bottom: 2px solid #eee;
      margin-bottom: 20px;
    }
    
    .report-logo {
      font-size: 2rem;
      margin-right: 15px;
      color: var(--primary-color);
    }
    
    .report-title {
      flex-grow: 1;
    }
    
    .report-title h1 {
      font-size: 1.8rem;
      margin-bottom: 5px;
    }
    
    .checklist-table {
      width: 100%;
      border-collapse: collapse;
      margin: 20px 0;
    }
    
    .checklist-table th, .checklist-table td {
      padding: 10px;
      border: 1px solid #ddd;
    }
    
    .checklist-table th {
      background-color: #f2f2f2;
      text-align: left;
      width: 35%;
    }
    
    .checklist-table th:first-child {
      width: 50px;
      text-align: center;
    }
    
    .section-title {
      display: flex;
      align-items: center;
      margin: 20px 0 15px;
      font-size: 1.2rem;
      color: var(--primary-color);
    }
    
    .section-title span {
      margin-right: 10px;
    }
    
    .beauty-code {
      display: flex;
      align-items: center;
      margin: 20px 0;
    }
    
    .beauty-code-letter {
      width: 50px;
      height: 50px;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-right: 10px;
      border-radius: 10px;
      font-size: 1.8rem;
      font-weight: bold;
      color: white;
      background-color: var(--primary-color);
    }
    
    .type-description {
      background-color: #f9f9f9;
      padding: 15px;
      border-radius: 5px;
      margin: 15px 0;
      border-left: 4px solid var(--primary-color);
    }
    
    .feature-list, .product-recommendations {
      margin: 20px 0;
    }
    
    .feature-item, .product-item {
      display: flex;
      align-items: flex-start;
      margin-bottom: 10px;
    }
    
    .feature-icon, .product-icon {
      flex-shrink: 0;
      width: 24px;
      height: 24px;
      margin-right: 10px;
      color: var(--primary-color);
    }
    
    .tip-box {
      background-color: #fff8e1;
      border-left: 4px solid #ffc107;
      padding: 15px;
      margin: 20px 0;
      border-radius: 5px;
    }
    
    .footer-note {
      font-size: 0.9rem;
      color: #666;
      margin-top: 30px;
      text-align: center;
      border-top: 1px solid #eee;
      padding-top: 15px;
    }
    
    .action-buttons {
      display: flex;
      justify-content: center;
      margin-top: 30px;
    }
    
    .action-button {
      margin: 0 10px;
      padding: 10px 20px;
      cursor: pointer;
      border: none;
      border-radius: 5px;
      font-weight: bold;
    }
    
    .pdf-button {
      background-color: #f44336;
      color: white;
    }
    
    .restart-button {
      background-color: #2196f3;
      color: white;
    }
    
    .analysis-table {
      width: 100%;
      border-collapse: collapse;
      margin: 20px 0;
    }
    
    .analysis-table th, .analysis-table td {
      padding: 12px;
      border: 1px solid #ddd;
    }
    
    .analysis-table th {
      background-color: var(--primary-color);
      color: white;
      text-align: left;
    }
    
    .care-routine {
      margin: 20px 0;
      padding: 15px;
      background-color: #e8f5e9;
      border-radius: 5px;
      border-left: 4px solid #4caf50;
    }
    
    .care-routine h4 {
      margin-bottom: 10px;
      color: #2e7d32;
    }
    
    .care-routine ul {
      padding-left: 20px;
    }
    
    .care-routine li {
      margin-bottom: 5px;
    }

    @media print {
      .no-print {
        display: none;
      }
      
      body {
        background-color: white;
      }
      
      .container {
        max-width: 100%;
        padding: 0;
      }
      
      .main-container {
        display: block;
      }
      
      .survey-section {
        display: none;
      }
      
      .result-section {
        width: 100%;
      }
      
      .card {
        box-shadow: none;
        padding: 0;
      }
      
      .type-description, .care-routine, .tip-box {
        border-left: 1px solid #ddd;
      }
      
      .beauty-code-letter {
        print-color-adjust: exact;
        -webkit-print-color-adjust: exact;
      }
      
      .analysis-table th {
        print-color-adjust: exact;
        -webkit-print-color-adjust: exact;
      }
    }
    
    @media (max-width: 768px) {
      .main-container {
        flex-direction: column;
      }
      
      .options {
        flex-direction: column;
      }
      
      .radio-group {
        flex-direction: row;
        margin-bottom: 10px;
        width: 100%;
        justify-content: space-between;
      }
      
      .option-label {
        margin-left: 10px;
        text-align: left;
      }
      
      .action-buttons {
        flex-direction: column;
      }
      
      .action-button {
        margin: 10px 0;
      }
      
      .beauty-code {
        flex-wrap: wrap;
        justify-content: center;
      }
      
      .beauty-code-letter {
        margin-bottom: 10px;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>피부 코드 진단 시스템</h1>
      <p>설문에 응답하여 당신만의 뷰티 코드를 확인해보세요!</p>
    </header>
    
    <div class="main-container">
      <!-- 설문 섹션 -->
      <div class="survey-section card">
        <h2>피부 설문지</h2>
        <form id="skinSurvey">
          <div class="form-group">
            <label>1. 성별</label>
            <div class="options">
              <div class="radio-group">
                <input type="radio" id="gender-female" name="gender" value="female" required>
                <span class="option-label">여성</span>
              </div>
              <div class="radio-group">
                <input type="radio" id="gender-male" name="gender" value="male">
                <span class="option-label">남성</span>
              </div>
            </div>
          </div>
          
          <div class="form-group">
            <label>2. 연령대</label>
            <div class="options">
              <div class="radio-group">
                <input type="radio" id="age-teens" name="age" value="10s" required>
                <span class="option-label">10대</span>
              </div>
              <div class="radio-group">
                <input type="radio" id="age-20s" name="age" value="20s">
                <span class="option-label">20대</span>
              </div>
              <div class="radio-group">
                <input type="radio" id="age-30s" name="age" value="30s">
                <span class="option-label">30대</span>
              </div>
              <div class="radio-group">
                <input type="radio" id="age-40s" name="age" value="40s">
                <span class="option-label">40대</span>
              </div>
              <div class="radio-group">
                <input type="radio" id="age-50s" name="age" value="50s">
                <span class="option-label">50대</span>
              </div>
              <div class="radio-group">
                <input type="radio" id="age-60s" name="age" value="60s">
                <span class="option-label">60대 이상</span>
              </div>
            </div>
          </div>
          
          <div class="form-group">
            <label>3. 수분 섭취량</label>
            <div class="options">
              <div class="radio-group">
                <input type="radio" id="hydration-verylow" name="hydration" value="1" required>
                <span class="option-label">매우 부족</span>
              </div>
              <div class="radio-group">
                <input type="radio" id="hydration-low" name="hydration" value="2">
                <span class="option-label">부족</span>
              </div>
              <div class="radio-group">
                <input type="radio" id="hydration-medium" name="hydration" value="3">
                <span class="option-label">보통</span>
              </div>
              <div class="radio-group">
                <input type="radio" id="hydration-high" name="hydration" value="4">
                <span class="option-label">충분</span>
              </div>
              <div class="radio-group">
                <input type="radio" id="hydration-veryhigh" name="hydration" value="5">
                <span class="option-label">매우 충분</span>
              </div>
            </div>
          </div>
          
          <div class="form-group">
            <label>4. 세안 후 당김</label>
            <div class="options">
              <div class="radio-group">
                <input type="radio" id="tightness-none" name="tightness" value="1" required>
                <span class="option-label">전혀 없음</span>
              </div>
              <div class="radio-group">
                <input type="radio" id="tightness-little" name="tightness" value="2">
                <span class="option-label">약간 있음</span>
              </div>
              <div class="radio-group">
                <input type="radio" id="tightness-medium" name="tightness" value="3">
                <span class="option-label">보통</span>
              </div>
              <div class="radio-group">
                <input type="radio" id="tightness-often" name="tightness" value="4">
                <span class="option-label">자주 느껴짐</span>
              </div>
              <div class="radio-group">
                <input type="radio" id="tightness-always" name="tightness" value="5">
                <span class="option-label">항상 당김</span>
              </div>
            </div>
          </div>
          
          <div class="form-group">
            <label>5. 트러블 빈도</label>
            <div class="options">
              <div class="radio-group">
                <input type="radio" id="trouble-none" name="trouble" value="1" required>
                <span class="option-label">없음</span>
              </div>
              <div class="radio-group">
                <input type="radio" id="trouble-rarely" name="trouble" value="2">
                <span class="option-label">가끔</span>
              </div>
              <div class="radio-group">
                <input type="radio" id="trouble-sometimes" name="trouble" value="3">
                <span class="option-label">보통</span>
              </div>
              <div class="radio-group">
                <input type="radio" id="trouble-often" name="trouble" value="4">
                <span class="option-label">자주</span>
              </div>
              <div class="radio-group">
                <input type="radio" id="trouble-always" name="trouble" value="5">
                <span class="option-label">항상 있음</span>
              </div>
            </div>
          </div>
          
          <div class="form-group">
            <label>6. 피부 민감도</label>
            <div class="options">
              <div class="radio-group">
                <input type="radio" id="sensitivity-verylow" name="sensitivity" value="1" required>
                <span class="option-label">매우 둔감</span>
              </div>
              <div class="radio-group">
                <input type="radio" id="sensitivity-low" name="sensitivity" value="2">
                <span class="option-label">약간 둔감</span>
              </div>
              <div class="radio-group">
                <input type="radio" id="sensitivity-medium" name="sensitivity" value="3">
                <span class="option-label">보통</span>
              </div>
              <div class="radio-group">
                <input type="radio" id="sensitivity-high" name="sensitivity" value="4">
                <span class="option-label">민감</span>
              </div>
              <div class="radio-group">
                <input type="radio" id="sensitivity-veryhigh" name="sensitivity" value="5">
                <span class="option-label">매우 민감</span>
              </div>
            </div>
          </div>
          
          <div class="form-group">
            <label>7. 피지 분비량</label>
            <div class="options">
              <div class="radio-group">
                <input type="radio" id="sebum-verylow" name="sebum" value="1" required>
                <span class="option-label">매우 적음</span>
              </div>
              <div class="radio-group">
                <input type="radio" id="sebum-low" name="sebum" value="2">
                <span class="option-label">적음</span>
              </div>
              <div class="radio-group">
                <input type="radio" id="sebum-medium" name="sebum" value="3">
                <span class="option-label">보통</span>
              </div>
              <div class="radio-group">
                <input type="radio" id="sebum-high" name="sebum" value="4">
                <span class="option-label">많음</span>
              </div>
              <div class="radio-group">
                <input type="radio" id="sebum-veryhigh" name="sebum" value="5">
                <span class="option-label">매우 많음</span>
              </div>
            </div>
          </div>
          
          <div class="form-group">
            <label>8. T존/U존 특성</label>
            <div class="options">
              <div class="radio-group">
                <input type="radio" id="zone-alldry" name="zone" value="1" required>
                <span class="option-label">전체 건성</span>
              </div>
              <div class="radio-group">
                <input type="radio" id="zone-toily" name="zone" value="2">
                <span class="option-label">T존만 지성</span>
              </div>
              <div class="radio-group">
                <input type="radio" id="zone-uoily" name="zone" value="3">
                <span class="option-label">U존만 지성</span>
              </div>
              <div class="radio-group">
                <input type="radio" id="zone-alloily" name="zone" value="4">
                <span class="option-label">전체 지성</span>
              </div>
              <div class="radio-group">
                <input type="radio" id="zone-mixed" name="zone" value="5">
                <span class="option-label">혼합성</span>
              </div>
            </div>
          </div>
          
          <div class="form-group">
            <label>9. 피부 혈색/톤</label>
            <div class="options">
              <div class="radio-group">
                <input type="radio" id="tone-verybright" name="tone" value="1" required>
                <span class="option-label">매우 밝음</span>
              </div>
              <div class="radio-group">
                <input type="radio" id="tone-bright" name="tone" value="2">
                <span class="option-label">밝음</span>
              </div>
              <div class="radio-group">
                <input type="radio" id="tone-medium" name="tone" value="3">
                <span class="option-label">보통</span>
              </div>
              <div class="radio-group">
                <input type="radio" id="tone-dark" name="tone" value="4">
                <span class="option-label">어두움</span>
              </div>
              <div class="radio-group">
                <input type="radio" id="tone-verydark" name="tone" value="5">
                <span class="option-label">매우 어두움</span>
              </div>
            </div>
          </div>
          
          <button type="submit" id="submit-btn">결과 보기</button>
        </form>
      </div>
      
      <!-- 결과 섹션 -->
      <div class="result-section card" id="result-container">
        <div class="report-header">
          <div class="report-logo">💎</div>
          <div class="report-title">
            <h1>BEAUTY CODE AI 피부 진단 결과</h1>
          </div>
        </div>
        
        <div class="section-title">
          <span>📋</span> 당신의 BEAUTY CODE
        </div>
        
        <div>
          <div class="beauty-code">
            <div class="beauty-code-letter" id="code-letter-1">-</div>
            <div class="beauty-code-letter" id="code-letter-2">-</div>
            <div class="beauty-code-letter" id="code-letter-3">-</div>
            <div class="beauty-code-letter" id="code-letter-4">-</div>
          </div>
          <h3 id="skin-type-name" style="text-align:center; margin-bottom:15px;"></h3>
          <div id="type-description" class="type-description">
            피부 타입 설명이 여기에 표시됩니다.
          </div>
        </div>
        
        <div class="section-title">
          <span>🔬</span> 상세 피부 분석
        </div>
        
        <table class="analysis-table">
          <tr>
            <th>항목</th>
            <th>분석 결과</th>
          </tr>
          <tr>
            <td>수분 상태</td>
            <td id="hydration-result"></td>
          </tr>
          <tr>
            <td>민감도</td>
            <td id="sensitivity-result"></td>
          </tr>
          <tr>
            <td>트러블 빈도</td>
            <td id="trouble-result"></td>
          </tr>
          <tr>
            <td>피부 톤/혈색</td>
            <td id="tone-result"></td>
          </tr>
        </table>
        
        <div class="section-title">
          <span>✅</span> 주요 특징
        </div>
        
        <div class="feature-list" id="feature-list">
          <!-- 특징 항목들이 여기에 동적으로 추가됩니다 -->
        </div>
        
        <div class="section-title">
          <span>📋</span> 맞춤형 스킨케어 루틴
        </div>
        
        <div class="care-routine">
          <h4>AM 루틴</h4>
          <ul id="am-routine">
            <!-- AM 루틴 항목들이 여기에 동적으로 추가됩니다 -->
          </ul>
          
          <h4 style="margin-top: 15px;">PM 루틴</h4>
          <ul id="pm-routine">
            <!-- PM 루틴 항목들이 여기에 동적으로 추가됩니다 -->
          </ul>
        </div>
        
        <div class="section-title">
          <span>🔒</span> 추천 제품
        </div>
        
        <div class="product-recommendations" id="product-list">
          <!-- 제품 추천 목록이 여기에 동적으로 추가됩니다 -->
        </div>
        
        <div class="tip-box">
          <p><strong>TIP:</strong> 제품 테스트 전, 팔 안쪽에 먼저 발라보고 24시간 후 이상 반응 없을 시 사용하세요. 민감 피부는 새로운 제품 도입 시 패치 테스트가 매우 중요합니다.</p>
        </div>
        
        <div class="section-title">
          <span>🔍</span> 설문 응답 요약
        </div>
        
        <table class="checklist-table">
          <tr>
            <th>No.</th>
            <th>질문 구분</th>
            <th>답변 내용</th>
          </tr>
          <tr>
            <td>1</td>
            <td>성별</td>
            <td id="response-gender">-</td>
          </tr>
          <tr>
            <td>2</td>
            <td>연령대</td>
            <td id="response-age">-</td>
          </tr>
          <tr>
            <td>3</td>
            <td>수분 섭취량</td>
            <td id="response-hydration">-</td>
          </tr>
          <tr>
            <td>4</td>
            <td>세안 후 당김</td>
            <td id="response-tightness">-</td>
          </tr>
          <tr>
            <td>5</td>
            <td>트러블 빈도</td>
            <td id="response-trouble">-</td>
          </tr>
          <tr>
            <td>6</td>
            <td>피부 민감도</td>
            <td id="response-sensitivity">-</td>
          </tr>
          <tr>
            <td>7</td>
            <td>피지 분비량</td>
            <td id="response-sebum">-</td>
          </tr>
          <tr>
            <td>8</td>
            <td>T존/U존 특성</td>
            <td id="response-zone">-</td>
          </tr>
          <tr>
            <td>9</td>
            <td>피부 혈색</td>
            <td id="response-tone">-</td>
          </tr>
        </table>
        
        <div class="footer-note">
          <p>주석: 이 피부 진단은 과학적 연구와 임상 데이터를 기반으로 작성되었습니다. 단, 개인차가 있을 수 있으며, 피부 상태는 환경, 계절, 건강 상태 등에 따라 변할 수 있습니다.</p>
        </div>
        
        <div class="action-buttons no-print">
          <button type="button" class="action-button pdf-button" id="print-btn">결과 PDF 저장</button>
          <button type="button" class="action-button restart-button" id="reset-btn">다시 진단하기</button>
        </div>
      </div>
    </div>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const skinSurvey = document.getElementById('skinSurvey');
      const resultContainer = document.getElementByI